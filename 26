import datetime
import locale

# Necesario para que strptime entienda días y meses en español
locale.setlocale(locale.LC_TIME, "es_MX.UTF-8")  # o "Spanish_Mexico", "es-MX", según Windows

fecha_raw = "viernes, 5 de diciembre de 2025 03:45 p. m."

# Normalizar AM/PM al formato inglés
fecha_norm = fecha_raw.replace("p. m.", "PM").replace("a. m.", "AM")

fecha_dt = datetime.datetime.strptime(
    fecha_norm,
    "%A, %d de %B de %Y %I:%M %p"
)

print(fecha_dt)





# Paso 6: Aplicar tu lógica original de actualización
if not df_ilo.empty and not df_ilocalizables.empty:
    df_merge = df_trabajo[mask_trabajo_ilo].merge(
        df_ilocalizables[['NUMERO_DE_CONTRATO', 'BR'] + columnas_actualizar],
        on=['NUMERO_DE_CONTRATO', 'BR'],
        how='left',
        suffixes=('', '_nuevo')
    )

    for col in columnas_actualizar:
        col_nueva = col + '_nuevo'
        if col_nueva in df_merge.columns:
            df_trabajo.loc[mask_trabajo_ilo, col] = df_merge[col_nueva].combine_first(df_merge[col])
