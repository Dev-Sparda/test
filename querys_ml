SELECT 
    fecha.FECHA_DATOS,
    subsidiarias.SUBSIDIARIA,
    '15694' AS CONCEPTO_C,
    COALESCE(SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END), 0) AS MONTO_C,
    '15685' AS CONCEPTO_A,
    COALESCE(SUM(CASE WHEN e.CONCEPTO = '15685' THEN e.MONTO ELSE 0 END), 0) AS MONTO_A,
    '15683' AS CONCEPTO_B,
    COALESCE(SUM(CASE WHEN e.CONCEPTO = '15683' THEN e.MONTO ELSE 0 END), 0) AS MONTO_B,
    CASE 
        WHEN COALESCE(SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END), 0) > 0 
            AND COALESCE(SUM(CASE WHEN e.CONCEPTO = '15685' THEN e.MONTO ELSE 0 END), 0) >= 
                CASE WHEN (COALESCE(SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END), 0) - 
                          COALESCE(SUM(CASE WHEN e.CONCEPTO = '15683' THEN e.MONTO ELSE 0 END), 0)) > 0 
                     THEN (COALESCE(SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END), 0) - 
                           COALESCE(SUM(CASE WHEN e.CONCEPTO = '15683' THEN e.MONTO ELSE 0 END), 0))
                     ELSE 0 
                END
            AND COALESCE(SUM(CASE WHEN e.CONCEPTO = '15685' THEN e.MONTO ELSE 0 END), 0) <= 
                COALESCE(SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END), 0)
        THEN 1 
        ELSE 2 
    END AS RESULTADO
FROM (SELECT 'tu_fecha_here' AS FECHA_DATOS) fecha
CROSS JOIN (SELECT DISTINCT SUBSIDIARIA FROM ENTRADAS) subsidiarias
LEFT JOIN ENTRADAS e ON fecha.FECHA_DATOS = e.FECHA_DATOS 
    AND subsidiarias.SUBSIDIARIA = e.SUBSIDIARIA
    AND e.CONCEPTO IN ('15685', '15694', '15683')
GROUP BY fecha.FECHA_DATOS, subsidiarias.SUBSIDIARIA;
