SELECT 
    fecha.FECHA_DATOS,
    subsidiarias.SUBSIDIARIA,
    '15694' AS CONCEPTO_C,
    SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE NULL END) AS MONTO_C,
    '15685' AS CONCEPTO_A,
    SUM(CASE WHEN e.CONCEPTO = '15685' THEN e.MONTO ELSE NULL END) AS MONTO_A,
    '15683' AS CONCEPTO_B,
    SUM(CASE WHEN e.CONCEPTO = '15683' THEN e.MONTO ELSE NULL END) AS MONTO_B,
    CASE 
        WHEN SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE NULL END) IS NULL THEN NULL
        WHEN SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END) > 0 
            AND SUM(CASE WHEN e.CONCEPTO = '15685' THEN e.MONTO ELSE 0 END) >= 
                CASE WHEN (SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END) - 
                          SUM(CASE WHEN e.CONCEPTO = '15683' THEN e.MONTO ELSE 0 END)) > 0 
                     THEN (SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END) - 
                           SUM(CASE WHEN e.CONCEPTO = '15683' THEN e.MONTO ELSE 0 END))
                     ELSE 0 
                END
            AND SUM(CASE WHEN e.CONCEPTO = '15685' THEN e.MONTO ELSE 0 END) <= 
                SUM(CASE WHEN e.CONCEPTO = '15694' THEN e.MONTO ELSE 0 END)
        THEN 1 
        ELSE 2 
    END AS RESULTADO
FROM (SELECT 'tu_fecha_here' AS FECHA_DATOS) fecha
CROSS JOIN (SELECT DISTINCT SUBSIDIARIA FROM ENTRADAS) subsidiarias
LEFT JOIN ENTRADAS e ON fecha.FECHA_DATOS = e.FECHA_DATOS 
    AND subsidiarias.SUBSIDIARIA = e.SUBSIDIARIA
    AND e.CONCEPTO IN ('15685', '15694', '15683')
GROUP BY fecha.FECHA_DATOS, subsidiarias.SUBSIDIARIA;
